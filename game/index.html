<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">

    <title>Thinking Word</title>
  </head>
  <body style="background:   #58cbff;">
    <div class="container">

  <div class="row align-items-center">
    <div class="col"></div>
      
    
    <div class="col">
      <form action="inner.html" class="login-form">
        <h1>Thinking Word</h1>
        <button type="button" class="logbtn" value="" data-toggle="modal" data-target="#exampleModal" id="createroom">創建房間
        </button>
        <button type="button" class="logbtn" value="" data-toggle="modal" data-target="#exampleModal2" id="joinroom">加入房間</button>
        <!--button type="button" class="logbtn" value="" data-toggle="modal" data-target="#exampleModal">設定</button-->    

      </form>
    </div>
    <div class="col"></div>
     
    
  </div>
</div>
    
    
    <!-- Optional JavaScript; choose one of the two! -->

    <!-- Option 1: jQuery and Bootstrap Bundle (includes Popper) -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
  <script src="https://www.gstatic.com/firebasejs/7.24.0/firebase-app.js"></script>

<!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->
  <script src="https://www.gstatic.com/firebasejs/7.24.0/firebase-analytics.js"></script>

  <script src="https://www.gstatic.com/firebasejs/4.9.0/firebase.js"></script>

  <script src="https://www.gstatic.com/firebasejs/7.24.0/firebase.js"></script>
    <script type="text/javascript">
        var config = {
    apiKey: "AIzaSyCcTw_QM1QzrZBiMfBp0sVA1AqhQQcG32w",
    authDomain: "gameapp-a8f57.firebaseapp.com",
    databaseURL: "https://gameapp-a8f57.firebaseio.com",
    projectId: "gameapp-a8f57",
    storageBucket: "gameapp-a8f57.appspot.com",
    messagingSenderId: "450989909307",
  };
  // Initialize Firebase
  firebase.initializeApp(config);
  document.getElementById("joinroom").addEventListener("click", someFunction);
    var myNameRef = firebase.database().ref('Player/count');
  function someFunction(event) {
     myNameRef.once('value',function(snapshot){
            var nowplayer=snapshot.val();
          console.log(nowplayer);
          nowplayer++;
          localStorage.setItem('myNum',nowplayer);
          myNameRef.set(nowplayer);           
          /*guest.once('value', function (snapshot) {

            var per=snapshot.val();
            if(nowplayer<per){
              nowplayer++;
              localStorage.setItem('myNum', nowplayer);
              console.log(nowplayer);
              firebase.database().ref('button/player').set(nowplayer);
            }
            else if(nowplayer>=per){
              nowplayer=1;
              firebase.database().ref('button/player').set(nowplayer);
            }
        })*/

  })
  }
    $("#createroom").on("click",function(){
     var myNameRef = firebase.database().ref('Player/count');
     myNameRef.set(1);
     firebase.database().ref('Player/ready/1').set(true);
     localStorage.setItem('myNum',1);
     var readyper=firebase.database().ref('Player/ready/all');
     firebase.database().ref('Player/ready/all').set(1);
     readyper.on('value',function(snapshot){
      var temp = snapshot.val();

      if(temp!=3){
        $("#start").css("background-color","gray");        
      }
      else{
        $("#start").css("background-color","orange");
      }
     })
    })
   /*  myNameRef.once('value',function(snapshot){
            var nowplayer=snapshot.val();
          console.log(nowplayer);
          nowplayer++;
          localStorage.setItem('myNum',nowplayer);
          myNameRef.set(nowplayer);           
          guest.once('value', function (snapshot) {

            var per=snapshot.val();
            if(nowplayer<per){
              nowplayer++;
              localStorage.setItem('myNum', nowplayer);
              console.log(nowplayer);
              firebase.database().ref('button/player').set(nowplayer);
            }
            else if(nowplayer>=per){
              nowplayer=1;
              firebase.database().ref('button/player').set(nowplayer);
            }
        })

  })*/
  

    </script>
    <!-- Option 2: jQuery, Popper.js, and Bootstrap JS
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s" crossorigin="anonymous"></script>
    -->
  </body>
<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true" style=" margin-top: 50%; padding: 0 100px; ">
  <div class="modal-dialog  " >
    <div class="modal-content "style="background:   #0098dc;">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel" style="color:white;"></h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <!--div class="modal-body">
        <input type="submit" name="" value="" style="height: 50px; width: 100%; border-color: orange; border-radius: 50px;"-->
      </div-->
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal" style="width: 43%">取消</button>
        <button type="button" class="btn "  style="background-color: orange;width: 43%" id="start">開始</button>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="exampleModal2" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true" style=" margin-top: 50%; padding: 0 100px; ">
  <div class="modal-dialog  " >
    <div class="modal-content "style="background:   #0098dc;">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel" style="color:white;"></h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <!--div class="modal-body">
        <input type="submit" name="" value="" style="height: 50px; width: 100%; border-color: orange; border-radius: 50px;"-->
      </div-->
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal" style="width: 45%">取消</button>
        <button type="button" class="btn " id="ready" style="background-color: orange;width: 45%" >準備</button>
      </div>
    </div>
  </div>
</div>
<script type="text/javascript">
    var start =firebase.database().ref('Player/ready/start');
    start.on('value',function(snapshot){
      var start=snapshot.val();
      if(start==true){
          window.location.assign("inner.html");
      }
    })
  $( "#ready" ).on('click', function(){
    console.log("準備完成");
    var myNum = localStorage.getItem('myNum');  
    firebase.database().ref('Player/ready/'+myNum).set(true);
    var ready=firebase.database().ref('Player/ready/'+myNum);
    ready.once('value',function(snapshot){
     var t= snapshot.val();
     console.log(myNum+':'+t);
    })
    $("#ready").css("background-color","gray");
    var all=firebase.database().ref('Player/ready/all');
    all.once('value',function(snapshot){
    allnum=snapshot.val();
    allnum++;
    firebase.database().ref('Player/ready/all').set(allnum);
  })

});

    $( "#start" ).on('click', function(){

    var myNum = localStorage.getItem('myNum');  

    var test=firebase.database().ref('Player/ready/all');
    test.once('value',function(snapshot){
      
     var t= snapshot.val();
     console.log("幾個人進來了:"+t);
     if(t==3){
      firebase.database().ref('Player/ready/start').set(true);
      window.location.assign("inner.html");
     }
    })
    $("#ready").css("background-color","gray");
});
</script>

  <style type="text/css">

.login-form{
  width: 360px;
  background:   #58cbff;
  height: 500px;
  padding: 100px 45px;
  border-radius: 10px;
  position: relative;
  left: 50%;
  margin-top:100%;
  transform: translate(-50%,-50%);
}

.login-form h1{
  text-align: center;
  margin-bottom: ;

}
.logbtn{
  border-radius: 50px;
  display: block;
  width: 100%;
  height: 50px;
  border-width:  3px;
  border-color: #AC7300; 
  background: #FFB92C;
  background-size: 100%;
  color: #fff;
  outline: none;
  cursor: pointer;
  transition: .5s;
  margin-top: 40px;
  margin-bottom: 15px;
}

.logbtn:hover{
  background-position: right;
}

  </style>
</html>